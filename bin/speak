#!/bin/bash
# Text-to-Speech using gTTS
# Usage: speak "text to speak"

if [ $# -eq 0 ]; then
    echo "Usage: speak 'text to speak'"
else
    # Check for gTTS
    if python3 -c "import gtts" >/dev/null 2>&1; then
        python3 -c "
import sys
import os
import tempfile
from gtts import gTTS

try:
    text = ' '.join(sys.argv[1:])
    tts = gTTS(text=text, lang='en')
    
    # Create temp file
    fd, temp_path = tempfile.mkstemp(suffix='.mp3')
    os.close(fd)
    
    tts.save(temp_path)

    # Try players: ffplay, mpg123, cvlc
    players = [
        f'ffplay -nodisp -autoexit -loglevel quiet {temp_path} >/dev/null 2>&1',
        f'mpg123 -q {temp_path} >/dev/null 2>&1',
        f'cvlc --play-and-exit {temp_path} >/dev/null 2>&1'
    ]

    print(f'Speaking: {text}')

    success = False
    for p in players:
        if os.system(p) == 0:
            success = True
            break

    if not success:
        print('(Audio playback failed - install ffplay or mpg123)')

    if os.path.exists(temp_path):
        os.remove(temp_path)

except Exception as e:
    print(f'Error: {e}')
" "$@"
    else
        echo "Error: gTTS python package not found. Run: pip install gTTS"
        echo "Text: $*"
    fi
fi
